pipeline {

    agent {
	docker {
	   image 'node:8.16.0-alpine'
	}
    }
    
    stages {
        stage('build') {
            when {
              changeset '**/result/**'
            }
            steps {
                echo 'Compiling result app'
		dir('result') {
	           sh 'npm install'
                }
            }
        }
         stage('test') {
            when {
              changeset '**/result/**'
            }
            steps {
                echo 'Running unit tests on result app'
                dir('worker') {
                  sh 'npm install'
                  sh 'npm test'
                }
            }
        }
    }
    
    post {
        always {
            echo 'Pipeline for worker is complete..'
        }
    }
}
